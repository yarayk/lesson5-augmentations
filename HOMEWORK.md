# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ –∫ —É—Ä–æ–∫—É 5: –ê—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∏ —Ä–∞–±–æ—Ç–∞ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏

## –î–∞—Ç–∞—Å–µ—Ç

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–∞—Ç–∞—Å–µ—Ç —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≥–µ—Ä–æ–µ–≤, —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–∞–ø–æ–∫:
```
data/
‚îú‚îÄ‚îÄ train/
‚îÇ   ‚îú‚îÄ‚îÄ hero1/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ image1.jpg
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îú‚îÄ‚îÄ hero2/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ val/
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ test/
    ‚îî‚îÄ‚îÄ ...
```

–î–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–ª–∞—Å—Å `CustomImageDataset` –∏–∑ `datasets.py`.

---

## –ó–∞–¥–∞–Ω–∏–µ 1: –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ torchvision (15 –±–∞–ª–ª–æ–≤)

1. –°–æ–∑–¥–∞–π—Ç–µ –ø–∞–π–ø–ª–∞–π–Ω —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π torchvision (–Ω–∞–ø—Ä–∏–º–µ—Ä, RandomHorizontalFlip, RandomCrop, ColorJitter, RandomRotation, RandomGrayscale).
2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –∫ 5 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏–∑ —Ä–∞–∑–Ω—ã—Ö –∫–ª–∞—Å—Å–æ–≤ (–ø–∞–ø–∫–∞ train).
3. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ:
   - –û—Ä–∏–≥–∏–Ω–∞–ª
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –æ—Ç–¥–µ–ª—å–Ω–æ
   - –†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π –≤–º–µ—Å—Ç–µ

---

## –ó–∞–¥–∞–Ω–∏–µ 2: –ö–∞—Å—Ç–æ–º–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (20 –±–∞–ª–ª–æ–≤)

1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –º–∏–Ω–∏–º—É–º 3 –∫–∞—Å—Ç–æ–º–Ω—ã–µ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–ª—É—á–∞–π–Ω–æ–µ —Ä–∞–∑–º—ã—Ç–∏–µ, —Å–ª—É—á–∞–π–Ω–∞—è –ø–µ—Ä—Å–ø–µ–∫—Ç–∏–≤–∞, —Å–ª—É—á–∞–π–Ω–∞—è —è—Ä–∫–æ—Å—Ç—å/–∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω–æ—Å—Ç—å).
2. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∏—Ö –∫ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º –∏–∑ train.
3. –°—Ä–∞–≤–Ω–∏—Ç–µ –≤–∏–∑—É–∞–ª—å–Ω–æ —Å –≥–æ—Ç–æ–≤—ã–º–∏ –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏—è–º–∏ –∏–∑ extra_augs.py.

---

## –ó–∞–¥–∞–Ω–∏–µ 3: –ê–Ω–∞–ª–∏–∑ –¥–∞—Ç–∞—Å–µ—Ç–∞ (10 –±–∞–ª–ª–æ–≤)

1. –ü–æ–¥—Å—á–∏—Ç–∞–π—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –∫–∞–∂–¥–æ–º –∫–ª–∞—Å—Å–µ.
2. –ù–∞–π–¥–∏—Ç–µ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π, –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏ —Å—Ä–µ–¥–Ω–∏–π —Ä–∞–∑–º–µ—Ä—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π.
3. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –∏ –≥–∏—Å—Ç–æ–≥—Ä–∞–º–º—É –ø–æ –∫–ª–∞—Å—Å–∞–º.

---

## –ó–∞–¥–∞–Ω–∏–µ 4: Pipeline –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π (20 –±–∞–ª–ª–æ–≤)

1. –†–µ–∞–ª–∏–∑—É–π—Ç–µ –∫–ª–∞—Å—Å AugmentationPipeline —Å –º–µ—Ç–æ–¥–∞–º–∏:
   - add_augmentation(name, aug)
   - remove_augmentation(name)
   - apply(image)
   - get_augmentations()
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π (light, medium, heavy).
3. –ü—Ä–∏–º–µ–Ω–∏—Ç–µ –∫–∞–∂–¥—É—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫ train –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.

---

## –ó–∞–¥–∞–Ω–∏–µ 5: –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å —Ä–∞–∑–º–µ—Ä–∞–º–∏ (10 –±–∞–ª–ª–æ–≤)

1. –ü—Ä–æ–≤–µ–¥–∏—Ç–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç —Å —Ä–∞–∑–Ω—ã–º–∏ —Ä–∞–∑–º–µ—Ä–∞–º–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, 64x64, 128x128, 224x224, 512x512).
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞ –∏–∑–º–µ—Ä—å—Ç–µ –≤—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∞—É–≥–º–µ–Ω—Ç–∞—Ü–∏–π –∫ 100 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º, –∞ —Ç–∞–∫–∂–µ –ø–æ—Ç—Ä–µ–±–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏.
3. –ü–æ—Å—Ç—Ä–æ–π—Ç–µ –≥—Ä–∞—Ñ–∏–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–∞–º—è—Ç–∏ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞.

---

## –ó–∞–¥–∞–Ω–∏–µ 6: –î–æ–æ–±—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π (25 –±–∞–ª–ª–æ–≤)

1. –í–æ–∑—å–º–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π torchvision (–Ω–∞–ø—Ä–∏–º–µ—Ä, resnet18, efficientnet_b0, mobilenet_v3_small).
2. –ó–∞–º–µ–Ω–∏—Ç–µ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–æ–π –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–ª–∞—Å—Å–æ–≤ –≤–∞—à–µ–≥–æ –¥–∞—Ç–∞—Å–µ—Ç–∞.
3. –î–æ–æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å –Ω–∞ train, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞—á–µ—Å—Ç–≤–æ –Ω–∞ val.
4. –í–∏–∑—É–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è (loss/accuracy).

**–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ –¥–ª—è ResNet18:**
```python
import torch
import torchvision
from torchvision import transforms, models
from torch.utils.data import DataLoader
from datasets import CustomImageDataset

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞—Ç–∞—Å–µ—Ç–∞
transform = transforms.Compose([
    transforms.Resize((224, 224)),
    transforms.ToTensor()
])
train_dataset = CustomImageDataset('data/train', transform=transform)
val_dataset = CustomImageDataset('data/val', transform=transform)
train_loader = DataLoader(train_dataset, batch_size=32, shuffle=True)
val_loader = DataLoader(val_dataset, batch_size=32)

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥–æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
model = models.resnet18(weights='IMAGENET1K_V1')
model.fc = torch.nn.Linear(model.fc.in_features, len(train_dataset.get_class_names()))

# –û–±—É—á–µ–Ω–∏–µ (–ø—Ä–∏–º–µ—Ä)
optimizer = torch.optim.Adam(model.parameters(), lr=1e-3)
loss_fn = torch.nn.CrossEntropyLoss()
for epoch in range(3):
    model.train()
    for x, y in train_loader:
        optimizer.zero_grad()
        out = model(x)
        loss = loss_fn(out, y)
        loss.backward()
        optimizer.step()
    print(f'Epoch {epoch+1} done!')
```

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∫–æ–¥—É
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –ø–∞–ø–∫—É train –¥–ª—è –æ–±—É—á–µ–Ω–∏—è (val/test ‚Äî —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞).
- –ö–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ö–æ—Ä–æ—à–æ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω.
- –í—Å–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏ –≥—Ä–∞—Ñ–∏–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤ –ø–∞–ø–∫—É results/.

## –°—Ä–æ–∫ —Å–¥–∞—á–∏
–î–æ –Ω–∞—á–∞–ª–∞ –∑–∞–Ω—è—Ç–∏—è 7.

–£–¥–∞—á–∏ –≤ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è! üöÄ 